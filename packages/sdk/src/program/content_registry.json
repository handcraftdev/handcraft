{
  "address": "EvnyqtTHHeNYoeauSgXMAUSu4EFeEsbxUxVzhC2NaDHU",
  "metadata": {
    "name": "content_registry",
    "version": "0.1.0",
    "spec": "0.1.0",
    "description": "Handcraft on-chain content registry"
  },
  "instructions": [
    {
      "name": "configure_mint",
      "docs": [
        "Configure NFT minting for content (creator only)"
      ],
      "discriminator": [194, 40, 217, 137, 179, 23, 131, 160],
      "accounts": [
        { "name": "content" },
        {
          "name": "mint_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [109, 105, 110, 116, 95, 99, 111, 110, 102, 105, 103] },
              { "kind": "account", "path": "content" }
            ]
          }
        },
        {
          "name": "creator",
          "writable": true,
          "signer": true,
          "relations": ["content"]
        },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": [
        { "name": "price", "type": "u64" },
        { "name": "max_supply", "type": { "option": "u64" } },
        { "name": "creator_royalty_bps", "type": "u16" }
      ]
    },
    {
      "name": "delete_content",
      "docs": ["Delete content (creator only, not locked)"],
      "discriminator": [5, 233, 219, 88, 173, 220, 96, 213],
      "accounts": [
        { "name": "content", "writable": true },
        { "name": "cid_registry", "writable": true },
        {
          "name": "creator",
          "writable": true,
          "signer": true,
          "relations": ["content"]
        }
      ],
      "args": []
    },
    {
      "name": "delete_content_with_mint",
      "docs": ["Delete content with associated mint config (creator only, not locked)"],
      "discriminator": [217, 53, 24, 118, 52, 28, 241, 83],
      "accounts": [
        { "name": "content", "writable": true },
        { "name": "cid_registry", "writable": true },
        {
          "name": "mint_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [109, 105, 110, 116, 95, 99, 111, 110, 102, 105, 103] },
              { "kind": "account", "path": "content" }
            ]
          }
        },
        {
          "name": "creator",
          "writable": true,
          "signer": true,
          "relations": ["content", "mint_config"]
        }
      ],
      "args": []
    },
    {
      "name": "initialize_ecosystem",
      "docs": ["Initialize the ecosystem config and global reward pool (admin only, once)"],
      "discriminator": [103, 159, 177, 39, 191, 146, 190, 22],
      "accounts": [
        {
          "name": "ecosystem_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [101, 99, 111, 115, 121, 115, 116, 101, 109] }
            ]
          }
        },
        {
          "name": "global_reward_pool",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [103, 108, 111, 98, 97, 108, 95, 114, 101, 119, 97, 114, 100, 95, 112, 111, 111, 108] }
            ]
          }
        },
        { "name": "treasury" },
        { "name": "admin", "writable": true, "signer": true },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": [
        { "name": "usdc_mint", "type": "pubkey" }
      ]
    },
    {
      "name": "mint_nft_sol",
      "docs": ["Mint NFT with SOL payment using global reward pool"],
      "discriminator": [246, 203, 253, 176, 41, 171, 75, 92],
      "accounts": [
        {
          "name": "ecosystem_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [101, 99, 111, 115, 121, 115, 116, 101, 109] }
            ]
          }
        },
        { "name": "content", "writable": true },
        {
          "name": "mint_config",
          "pda": {
            "seeds": [
              { "kind": "const", "value": [109, 105, 110, 116, 95, 99, 111, 110, 102, 105, 103] },
              { "kind": "account", "path": "content" }
            ]
          }
        },
        {
          "name": "global_reward_pool",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [103, 108, 111, 98, 97, 108, 95, 114, 101, 119, 97, 114, 100, 95, 112, 111, 111, 108] }
            ]
          }
        },
        {
          "name": "nft_reward_state",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [110, 102, 116, 95, 114, 101, 119, 97, 114, 100] },
              { "kind": "account", "path": "nft_asset" }
            ]
          }
        },
        { "name": "creator", "writable": true },
        { "name": "platform", "writable": true, "optional": true },
        { "name": "treasury", "writable": true },
        { "name": "buyer", "writable": true, "signer": true },
        { "name": "nft_asset", "writable": true, "signer": true },
        { "name": "mpl_core_program", "address": "CoREENxT6tW1HoK8ypY1SxRMZTcVPm7R94rH4PZNhX7d" },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": []
    },
    {
      "name": "claim_rewards",
      "docs": ["Claim accumulated rewards for an NFT from global pool"],
      "discriminator": [4, 144, 132, 71, 116, 23, 151, 80],
      "accounts": [
        {
          "name": "global_reward_pool",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [103, 108, 111, 98, 97, 108, 95, 114, 101, 119, 97, 114, 100, 95, 112, 111, 111, 108] }
            ]
          }
        },
        {
          "name": "nft_reward_state",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [110, 102, 116, 95, 114, 101, 119, 97, 114, 100] },
              { "kind": "account", "path": "nft_asset" }
            ]
          }
        },
        { "name": "nft_asset" },
        { "name": "holder", "writable": true, "signer": true },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": []
    },
    {
      "name": "register_content",
      "docs": ["Register new content with CID uniqueness enforcement"],
      "discriminator": [170, 55, 41, 115, 252, 248, 38, 144],
      "accounts": [
        {
          "name": "content",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [99, 111, 110, 116, 101, 110, 116] },
              { "kind": "arg", "path": "cid_hash" }
            ]
          }
        },
        {
          "name": "cid_registry",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [99, 105, 100] },
              { "kind": "arg", "path": "cid_hash" }
            ]
          }
        },
        { "name": "authority", "writable": true, "signer": true },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": [
        { "name": "cid_hash", "type": { "array": ["u8", 32] } },
        { "name": "content_cid", "type": "string" },
        { "name": "metadata_cid", "type": "string" },
        { "name": "content_type", "type": { "defined": { "name": "ContentType" } } },
        { "name": "is_encrypted", "type": "bool" },
        { "name": "preview_cid", "type": "string" },
        { "name": "encryption_meta_cid", "type": "string" }
      ]
    },
    {
      "name": "register_content_with_mint",
      "docs": ["Register new content with optional NFT mint configuration"],
      "discriminator": [126, 168, 92, 147, 68, 165, 193, 127],
      "accounts": [
        {
          "name": "content",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [99, 111, 110, 116, 101, 110, 116] },
              { "kind": "arg", "path": "cid_hash" }
            ]
          }
        },
        {
          "name": "cid_registry",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [99, 105, 100] },
              { "kind": "arg", "path": "cid_hash" }
            ]
          }
        },
        {
          "name": "mint_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [109, 105, 110, 116, 95, 99, 111, 110, 102, 105, 103] },
              { "kind": "account", "path": "content" }
            ]
          }
        },
        { "name": "authority", "writable": true, "signer": true },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": [
        { "name": "cid_hash", "type": { "array": ["u8", 32] } },
        { "name": "content_cid", "type": "string" },
        { "name": "metadata_cid", "type": "string" },
        { "name": "content_type", "type": { "defined": { "name": "ContentType" } } },
        { "name": "price", "type": "u64" },
        { "name": "max_supply", "type": { "option": "u64" } },
        { "name": "creator_royalty_bps", "type": "u16" },
        { "name": "is_encrypted", "type": "bool" },
        { "name": "preview_cid", "type": "string" },
        { "name": "encryption_meta_cid", "type": "string" }
      ]
    },
    {
      "name": "tip_content",
      "docs": ["Tip a creator for their content"],
      "discriminator": [12, 29, 43, 141, 181, 42, 144, 92],
      "accounts": [
        { "name": "content", "writable": true },
        { "name": "creator", "writable": true },
        { "name": "tipper", "writable": true, "signer": true },
        { "name": "system_program", "address": "11111111111111111111111111111111" }
      ],
      "args": [
        { "name": "amount", "type": "u64" }
      ]
    },
    {
      "name": "update_content",
      "docs": ["Update content metadata (creator only, not locked)"],
      "discriminator": [201, 145, 238, 112, 36, 231, 69, 8],
      "accounts": [
        { "name": "content", "writable": true },
        { "name": "creator", "signer": true, "relations": ["content"] }
      ],
      "args": [
        { "name": "metadata_cid", "type": "string" }
      ]
    },
    {
      "name": "update_ecosystem",
      "docs": ["Update ecosystem settings (admin only)"],
      "discriminator": [116, 15, 145, 34, 144, 187, 120, 42],
      "accounts": [
        {
          "name": "ecosystem_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [101, 99, 111, 115, 121, 115, 116, 101, 109] }
            ]
          }
        },
        { "name": "admin", "signer": true, "relations": ["ecosystem_config"] }
      ],
      "args": [
        { "name": "new_treasury", "type": { "option": "pubkey" } },
        { "name": "new_usdc_mint", "type": { "option": "pubkey" } },
        { "name": "is_paused", "type": { "option": "bool" } }
      ]
    },
    {
      "name": "update_mint_settings",
      "docs": ["Update mint settings (creator only, with restrictions after first mint)"],
      "discriminator": [46, 150, 169, 122, 14, 20, 173, 18],
      "accounts": [
        { "name": "content" },
        {
          "name": "mint_config",
          "writable": true,
          "pda": {
            "seeds": [
              { "kind": "const", "value": [109, 105, 110, 116, 95, 99, 111, 110, 102, 105, 103] },
              { "kind": "account", "path": "content" }
            ]
          }
        },
        { "name": "creator", "signer": true, "relations": ["content", "mint_config"] }
      ],
      "args": [
        { "name": "price", "type": { "option": "u64" } },
        { "name": "max_supply", "type": { "option": { "option": "u64" } } },
        { "name": "creator_royalty_bps", "type": { "option": "u16" } },
        { "name": "is_active", "type": { "option": "bool" } }
      ]
    }
  ],
  "accounts": [
    {
      "name": "CidRegistry",
      "discriminator": [76, 59, 180, 103, 33, 99, 115, 244]
    },
    {
      "name": "GlobalRewardPool",
      "discriminator": [253, 163, 35, 227, 96, 158, 106, 63]
    },
    {
      "name": "NftRewardState",
      "discriminator": [117, 51, 192, 35, 172, 30, 218, 77]
    },
    {
      "name": "ContentEntry",
      "discriminator": [8, 200, 227, 175, 3, 190, 190, 31]
    },
    {
      "name": "EcosystemConfig",
      "discriminator": [230, 1, 147, 206, 55, 106, 39, 15]
    },
    {
      "name": "MintConfig",
      "discriminator": [168, 252, 88, 182, 219, 205, 39, 53]
    }
  ],
  "events": [
    {
      "name": "NftMintEvent",
      "discriminator": [114, 195, 97, 207, 65, 217, 173, 157]
    },
    {
      "name": "TipEvent",
      "discriminator": [213, 36, 191, 50, 28, 25, 189, 252]
    },
    {
      "name": "ClaimRewardEvent",
      "discriminator": [156, 47, 92, 165, 31, 204, 187, 72]
    }
  ],
  "errors": [
    { "code": 6000, "name": "CidTooLong", "msg": "CID must be 64 characters or less" },
    { "code": 6001, "name": "InvalidTipAmount", "msg": "Tip amount must be greater than 0" },
    { "code": 6002, "name": "Unauthorized", "msg": "Unauthorized" },
    { "code": 6003, "name": "CidAlreadyRegistered", "msg": "Content CID already registered by another user" },
    { "code": 6004, "name": "CidHashMismatch", "msg": "CID hash does not match the provided CID" },
    { "code": 6005, "name": "ContentLocked", "msg": "Content is locked after first NFT mint" },
    { "code": 6006, "name": "MintConfigExists", "msg": "Mint configuration already exists for this content" },
    { "code": 6007, "name": "MintConfigNotFound", "msg": "Mint configuration not found" },
    { "code": 6008, "name": "MintingNotActive", "msg": "Minting is not active for this content" },
    { "code": 6009, "name": "MaxSupplyReached", "msg": "Maximum supply reached" },
    { "code": 6010, "name": "PriceTooLow", "msg": "Price below minimum allowed" },
    { "code": 6011, "name": "InvalidRoyalty", "msg": "Royalty percentage out of allowed range (2-10%)" },
    { "code": 6012, "name": "InsufficientPayment", "msg": "Insufficient payment amount" },
    { "code": 6013, "name": "InvalidCurrency", "msg": "Invalid payment currency" },
    { "code": 6014, "name": "CannotIncreaseSupply", "msg": "Cannot increase supply after minting has started" },
    { "code": 6015, "name": "SupplyBelowMinted", "msg": "Cannot set supply below already minted count" },
    { "code": 6016, "name": "EcosystemPaused", "msg": "Ecosystem is paused" },
    { "code": 6017, "name": "EcosystemAlreadyInitialized", "msg": "Ecosystem config already initialized" },
    { "code": 6018, "name": "InvalidUsdcMint", "msg": "Invalid USDC mint address" },
    { "code": 6019, "name": "NftMismatch", "msg": "NFT asset does not match the reward state" },
    { "code": 6020, "name": "NotNftOwner", "msg": "Holder does not own this NFT" },
    { "code": 6021, "name": "NothingToClaim", "msg": "No rewards available to claim" }
  ],
  "types": [
    {
      "name": "CidRegistry",
      "docs": ["Registry to ensure CID uniqueness across all content."],
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "owner", "docs": ["The owner who registered this CID"], "type": "pubkey" },
          { "name": "content_pda", "docs": ["The content PDA associated with this CID"], "type": "pubkey" },
          { "name": "registered_at", "docs": ["When this CID was registered"], "type": "i64" }
        ]
      }
    },
    {
      "name": "GlobalRewardPool",
      "docs": ["Global accumulated reward pool for all holder rewards"],
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "reward_per_share", "docs": ["Accumulated reward per share (scaled by PRECISION)"], "type": "u128" },
          { "name": "total_nfts", "docs": ["Total NFTs minted across all content"], "type": "u64" },
          { "name": "total_deposited", "docs": ["Total rewards ever deposited to the pool (lamports)"], "type": "u64" },
          { "name": "total_claimed", "docs": ["Total rewards claimed from the pool (lamports)"], "type": "u64" },
          { "name": "created_at", "docs": ["Timestamp when pool was created"], "type": "i64" }
        ]
      }
    },
    {
      "name": "NftRewardState",
      "docs": ["Per-NFT reward tracking state"],
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "nft_asset", "type": "pubkey" },
          { "name": "reward_debt", "docs": ["Reward debt - global reward_per_share at mint/last claim"], "type": "u128" },
          { "name": "created_at", "type": "i64" }
        ]
      }
    },
    {
      "name": "ContentEntry",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "creator", "type": "pubkey" },
          { "name": "content_cid", "type": "string" },
          { "name": "metadata_cid", "type": "string" },
          { "name": "content_type", "type": { "defined": { "name": "ContentType" } } },
          { "name": "tips_received", "type": "u64" },
          { "name": "created_at", "type": "i64" },
          { "name": "is_locked", "type": "bool" },
          { "name": "minted_count", "type": "u64" },
          { "name": "is_encrypted", "type": "bool" },
          { "name": "preview_cid", "type": "string" },
          { "name": "encryption_meta_cid", "type": "string" }
        ]
      }
    },
    {
      "name": "ContentType",
      "type": {
        "kind": "enum",
        "variants": [
          { "name": "Movie" },
          { "name": "TvSeries" },
          { "name": "MusicVideo" },
          { "name": "ShortVideo" },
          { "name": "GeneralVideo" },
          { "name": "Comic" },
          { "name": "GeneralBook" },
          { "name": "Podcast" },
          { "name": "Audiobook" },
          { "name": "GeneralAudio" },
          { "name": "Photo" },
          { "name": "Art" },
          { "name": "GeneralImage" }
        ]
      }
    },
    {
      "name": "EcosystemConfig",
      "docs": ["Global ecosystem configuration"],
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "admin", "docs": ["Admin who can update ecosystem settings"], "type": "pubkey" },
          { "name": "treasury", "docs": ["Treasury wallet to receive ecosystem fees"], "type": "pubkey" },
          { "name": "usdc_mint", "docs": ["USDC mint address (for USDC payments)"], "type": "pubkey" },
          { "name": "total_fees_sol", "docs": ["Total fees collected (SOL, in lamports)"], "type": "u64" },
          { "name": "total_fees_usdc", "docs": ["Total fees collected (USDC, in base units)"], "type": "u64" },
          { "name": "total_nfts_minted", "docs": ["Total NFTs minted across all content"], "type": "u64" },
          { "name": "is_paused", "docs": ["Whether the ecosystem is paused (emergency stop)"], "type": "bool" },
          { "name": "created_at", "docs": ["Timestamp when config was created"], "type": "i64" }
        ]
      }
    },
    {
      "name": "MintConfig",
      "docs": ["Mint configuration for a content entry"],
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "content", "docs": ["The content entry this config belongs to"], "type": "pubkey" },
          { "name": "creator", "docs": ["Creator who owns this config"], "type": "pubkey" },
          { "name": "price", "docs": ["Price per NFT (0 = free mint)"], "type": "u64" },
          { "name": "currency", "docs": ["Payment currency (SOL or USDC)"], "type": { "defined": { "name": "PaymentCurrency" } } },
          { "name": "max_supply", "docs": ["Maximum supply (None = unlimited)"], "type": { "option": "u64" } },
          { "name": "creator_royalty_bps", "docs": ["Creator royalty on secondary sales (basis points)"], "type": "u16" },
          { "name": "is_active", "docs": ["Whether minting is currently enabled"], "type": "bool" },
          { "name": "created_at", "docs": ["Timestamp when config was created"], "type": "i64" },
          { "name": "updated_at", "docs": ["Timestamp when config was last updated"], "type": "i64" }
        ]
      }
    },
    {
      "name": "NftMintEvent",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "content", "type": "pubkey" },
          { "name": "buyer", "type": "pubkey" },
          { "name": "creator", "type": "pubkey" },
          { "name": "edition_number", "type": "u64" },
          { "name": "price", "type": "u64" },
          { "name": "timestamp", "type": "i64" },
          { "name": "nft_asset", "type": "pubkey" }
        ]
      }
    },
    {
      "name": "PaymentCurrency",
      "docs": ["Payment currency options"],
      "type": {
        "kind": "enum",
        "variants": [
          { "name": "Sol" },
          { "name": "Usdc" }
        ]
      }
    },
    {
      "name": "TipEvent",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "content", "type": "pubkey" },
          { "name": "tipper", "type": "pubkey" },
          { "name": "creator", "type": "pubkey" },
          { "name": "amount", "type": "u64" },
          { "name": "timestamp", "type": "i64" }
        ]
      }
    },
    {
      "name": "ClaimRewardEvent",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "holder", "type": "pubkey" },
          { "name": "nft_asset", "type": "pubkey" },
          { "name": "amount", "type": "u64" },
          { "name": "timestamp", "type": "i64" }
        ]
      }
    }
  ]
}
